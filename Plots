## Plots used in Paper

################################
## Sample Distance (MDS Plot) ##
################################

plotMDS(dtot, method="bcv", col=as.numeric(dtot$samples$group))

###############
## HEAT MAP ###
###############

# get logcpm normalized values from raw counts
logcpm.tot <- cpm(dtot, prior.count=2, log=TRUE)
head(logcpm.tot)

# Find variance for each gene in dataset
var_genes.tot <- apply(logcpm.tot, 1, var)
head(var_genes.tot)
var_genes.tot

# Get the gene names for the top 200 most variable genes
select_var.tot <- names(sort(var_genes.tot, decreasing=TRUE))[1:200]
head(select_var.tot)
select_var.tot

# Subset the top 200 most variable genes from logcounts matrix
highly_variable_lcpm.tot <- logcpm.tot[select_var.tot,]
dim(highly_variable_lcpm.tot)
head(highly_variable_lcpm.tot)

# write into csv
write.csv(highly_variable_lcpm.tot,"/Users/sarah/Desktop/Honors Project/top200.csv")

## Colors for Heatmap
mypalette <- brewer.pal(11,"RdYlBu")
morecols <- colorRampPalette(mypalette)

# Set up color vector for day variable
col.cell.tot <- c("purple","orange","blue","pink","green","red")[dtot$samples$group]
col.cell.tot

# Plot the heatmap
heatmap.2(highly_variable_lcpm.tot,col=rev(morecols(50)),trace="none", main="Top 200 most variable genes across samples",ColSideColors=col.cell.tot,scale="row",labCol=dtot$samples$group)

##########################
## GENE EXPRESSION PLOTS ##
##########################

library(reshape2)
library(ggplot2)

## PR Gene Expression Boxplots
pr<-read.csv("/Users/sarah/Desktop/Honors Project/PR_genes.csv",header=T)
head(pr)

# create dataframe
pr<-data.frame(pr)

# Melt into one long dataframe
prm <- melt(pr)

# define value as logcpm
logcpm<-prm$value 

# factor devlopment days in correct order
prm$Day <- factor(prm$Day, levels=c("E3", "E5", "E8", "E16", "E18"))
prm$Day

# create boxplot
pr_boxplot<- ggplot(data=prm) + geom_boxplot(aes(x=Day,y=logcpm,fill=Day)) + facet_wrap(~variable)

# add title
pr_boxplot + ggtitle("PR Gene Expressions")


## TF Gene Expression Boxplots
tf<-read.csv("/Users/sarah/Desktop/Honors Project/TR_genes.csv",header=T)
head(tf)

# create dataframe
tf<-data.frame(tf)

# Melt into one long dataframe
tfm <- melt(tf)

# define value as logcpm
logcpm<-tfm$value 

# factor devlopment days in correct order
tfm$Day <- factor(tfm$Day, levels=c("E3", "E5", "E8", "E16", "E18"))
tfm$Day

# create boxplot
tf_boxplot<- ggplot(data=tfm) + geom_boxplot(aes(x=Day,y=logcpm,fill=Day)) + facet_wrap(~variable)

# add title
tf_boxplot + ggtitle("TF Gene Expressions")
